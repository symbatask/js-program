{"ast":null,"code":"import _toConsumableArray from\"/Users/symbat.askarova33gmail.com/Desktop/program-js/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/Users/symbat.askarova33gmail.com/Desktop/program-js/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import axios from'axios';import{GET_HOMEWORKS,GET_COMMENTS,CREATE_NEW_COMMENT,DELETE_COMMENT}from'../actions/actions';var initialState={homeworks:[],comments:[]};// eslint-disable-next-line import/no-anonymous-default-export\nexport default(function(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case GET_HOMEWORKS:return _objectSpread(_objectSpread({},state),{},{homeworks:action.homeworks});case GET_COMMENTS:return _objectSpread(_objectSpread({},state),{},{comments:action.comments||[]});case DELETE_COMMENT:return _objectSpread(_objectSpread({},state),{},{comments:action.comments});case CREATE_NEW_COMMENT:return _objectSpread(_objectSpread({},state),{},{comments:[].concat(_toConsumableArray(state.comments),[action.message])});default:return state;}});export function getHomeworks(){return function(dispatch){axios.get('/api/v1/homeworks').then(function(_ref){var homeworks=_ref.data;return dispatch({type:GET_HOMEWORKS,homeworks:homeworks});});};}export function getComments(work,user){return function(dispatch){axios.post('/api/v1/homeworks/comments',{work:work,user:user}).then(function(_ref2){var comments=_ref2.data;return dispatch({type:GET_COMMENTS,comments:comments});});};}export function createMessage(work,newMessage){var message=_objectSpread(_objectSpread({},newMessage),{},{date:+new Date()});return function(dispatch,getState){var comments=getState().homeworks.comments;comments=[].concat(_toConsumableArray(comments),[message]);axios.post('/api/v1/homeworks/comments/create',{work:work,comments:comments}).then(function(){return dispatch({type:CREATE_NEW_COMMENT,message:message});});};}export function deleteComment(work,date){return function(dispatch,getState){var comments=getState().homeworks.comments;comments=comments.filter(function(el){return el.date!==date;});axios.patch('/api/v1/homeworks/comments/delete',{work:work,comments:comments}).then(function(_ref3){var data=_ref3.data;return data==='success'?dispatch({type:DELETE_COMMENT,comments:comments}):'';});};}","map":{"version":3,"sources":["/Users/symbat.askarova33gmail.com/Desktop/program-js/src/client/redux/reducers/homeworks.js"],"names":["axios","GET_HOMEWORKS","GET_COMMENTS","CREATE_NEW_COMMENT","DELETE_COMMENT","initialState","homeworks","comments","state","action","type","message","getHomeworks","dispatch","get","then","data","getComments","work","user","post","createMessage","newMessage","date","Date","getState","deleteComment","filter","el","patch"],"mappings":"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","sourcesContent":["import axios from 'axios'\r\nimport { GET_HOMEWORKS, GET_COMMENTS, CREATE_NEW_COMMENT, DELETE_COMMENT } from '../actions/actions'\r\n\r\nconst initialState = {\r\n  homeworks: [],\r\n  comments: []\r\n}\r\n// eslint-disable-next-line import/no-anonymous-default-export\r\nexport default (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case GET_HOMEWORKS:\r\n      return { ...state, homeworks: action.homeworks }\r\n    case GET_COMMENTS:\r\n      return { ...state, comments: action.comments || [] }\r\n    case DELETE_COMMENT:\r\n      return { ...state, comments: action.comments }\r\n    case CREATE_NEW_COMMENT:\r\n      return { ...state, comments: [...state.comments, action.message] }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport function getHomeworks() {\r\n  return (dispatch) => {\r\n    axios\r\n      .get('/api/v1/homeworks')\r\n      .then(({ data: homeworks }) => dispatch({ type: GET_HOMEWORKS, homeworks }))\r\n  }\r\n}\r\n\r\nexport function getComments(work, user) {\r\n  return (dispatch) => {\r\n    axios\r\n      .post('/api/v1/homeworks/comments', { work, user })\r\n      .then(({ data: comments }) => dispatch({ type: GET_COMMENTS, comments }))\r\n  }\r\n}\r\n\r\nexport function createMessage(work, newMessage) {\r\n  const message = {\r\n    ...newMessage,\r\n    date: +new Date()\r\n  }\r\n  return (dispatch, getState) => {\r\n    let { comments } = getState().homeworks\r\n    comments = [...comments, message]\r\n    axios.post('/api/v1/homeworks/comments/create', {\r\n      work,\r\n      comments\r\n    }).then(() => dispatch({ type: CREATE_NEW_COMMENT, message }))\r\n\r\n  }\r\n}\r\n\r\nexport function deleteComment(work, date) {\r\n  return (dispatch, getState) => {\r\n    let { comments } = getState().homeworks\r\n    comments = comments.filter((el) => el.date !== date)\r\n    axios.patch('/api/v1/homeworks/comments/delete', {\r\n      work,\r\n      comments\r\n    }).then(({data}) => data === 'success' ? dispatch({ type: DELETE_COMMENT, comments }) : '')\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}